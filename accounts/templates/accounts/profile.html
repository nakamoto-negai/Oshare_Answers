{% extends "base.html" %}

{% block title %}ページタイトル{% endblock %}

{% block content %}
  <!-- ページ固有の内容 -->
  <h2 class="profile-main-title">{{ user.username }}さんのプロフィール</h2>
  <section class="profile-section">
    <h3>所持しているクーポン</h3>
  <ul>
    {% for coupon in coupons %}
      <li>{{ coupon.code }}（割引: {{ coupon.discount }}%、有効期限: {{ coupon.valid_to|date:"Y-m-d" }}）</li>
    {% empty %}
      <li>所持しているクーポンはありません。</li>
    {% endfor %}
  </ul>
  </section>
  <section class="profile-section">
    <h3>自分のした質問</h3>
    <ul>
    {% for question in questions %}
      <li>{{ question.title }}（{{ question.created_at|date:"Y-m-d H:i" }}）</li>
    {% empty %}
      <li>投稿した質問はありません。</li>
    {% endfor %}
  </ul>
  </section>
  <section class="profile-section">
    <h3>自分のした回答</h3>
    <ul>
    {% for answer in answers %}
      <li>「{{ answer.question.title }}」への回答（{{ answer.created_at|date:"Y-m-d H:i" }}）<br>
        {{ answer.body|truncatechars:50 }}
      </li>
    {% empty %}
      <li>投稿した回答はありません。</li>
    {% endfor %}
  </ul>
  </section>

 
  <section class="profile-section">
       <h3>あなたへのおすすめ商品</h3>
        <ul>
          {% for rec in recommendations %}
            <li>
              {{ rec.item.name }}
              {% if rec.item.image %}
                <img src="{{ rec.item.image.url }}" alt="{{ rec.item.name }}" style="max-width:80px; max-height:80px;">
              {% endif %}
            </li>
          {% empty %}
            <li>おすすめ商品はありません。</li>
          {% endfor %}
        </ul>
  </section>
  <section class="profile-section">
    <h3>所持ポイント</h3>
    <p>{{ user.points }}</p>
  </section>
  <section class="profile-section">
    <h3>購入履歴</h3>
  <ul>
    {% for order in orders %}
      <li>
        {{ order.item.name }} × {{ order.quantity }}（{{ order.order_at|date:"Y-m-d H:i" }}）
      </li>
    {% empty %}
      <li>購入履歴はありません。</li>
    {% endfor %}
  </ul>
  </section>
{% endblock %}
